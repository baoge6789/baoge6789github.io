<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>挪车二维码生成器</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #qrcode { margin-top: 20px; }
        button { margin-top: 10px; padding: 10px 15px; font-size: 16px; }
        input { padding: 10px; font-size: 16px; width: calc(100% - 22px); }
        #action-buttons { display: none; margin-top: 20px; }
    </style>
</head>
<body>

<h1>挪车二维码生成器</h1>
<label for="plate">车牌号:</label>
<input type="text" id="plate" placeholder="请输入车牌号"><br>
<label for="phone">手机号:</label>
<input type="text" id="phone" placeholder="请输入手机号"><br>
<button id="generate">生成二维码</button>

<div id="qrcode"></div>

<div id="action-buttons">
    <p id="vehicle-info"></p>
    <button id="call">一键呼叫</button>
    <button id="sms">发送短信通知</button>
</div>

<script>
// 生成二维码
document.getElementById('generate').onclick = function() {
    const plate = document.getElementById('plate').value.trim();
    const phone = document.getElementById('phone').value.trim();

    if (!plate || !phone) {
        alert("请填写车牌号和手机号！");
        return;
    }

    // 使用特定格式生成二维码内容
    const content = `plate:${plate};phone:${phone}`;
    
    // 清空之前的二维码
    document.getElementById('qrcode').innerHTML = '';

    // 生成二维码
    $('#qrcode').qrcode({
        text: content,
        width: 200,
        height: 200
    });

    // 显示操作按钮和车辆信息
    document.getElementById('action-buttons').style.display = 'block';
};

// 一键呼叫
document.getElementById('call').onclick = function() {
    const phone = document.getElementById('phone').value.trim();
    if (phone) {
        window.location.href = `tel:${phone}`;
    } else {
        alert("未找到有效的手机号！");
    }
};

// 发送短信通知
document.getElementById('sms').onclick = function() {
    const phone = document.getElementById('phone').value.trim();
    if (phone) {
        window.location.href = `sms:${phone}?body=请挪车，谢谢！`;
    } else {
        alert("未找到有效的手机号！");
    }
};

// 模拟扫码后的处理（实际应用中需使用二维码扫描器）
function simulateQRCodeScan(qrContent) {
    const [plateInfo, phoneInfo] = qrContent.split(';');
    
    const plate = plateInfo.split(':')[1];
    const phone = phoneInfo.split(':')[1];

    // 显示车辆信息
    document.getElementById('vehicle-info').innerText = `车牌号：${plate}，手机号：${phone}`;

    // 显示操作按钮
    document.getElementById('action-buttons').style.display = 'block';
}

// 示例：模拟扫码后的调用（在实际应用中，这个函数会由扫码器调用）
document.getElementById('call').onclick = function() {
   const plate = document.getElementById('plate').value.trim();
   const phone = document.getElementById('phone').value.trim();
   if (plate && phone) {
       simulateQRCodeScan(`plate:${plate};phone:${phone}`);
   }
};

document.getElementById('sms').onclick = function() {
   const plate = document.getElementById('plate').value.trim();
   const phone = document.getElementById('phone').value.trim();
   if (plate && phone) {
       simulateQRCodeScan(`plate:${plate};phone:${phone}`);
   }
};
</script>

</body>
</html>
